/**
*
* Copyright (C) 2017 modela authors
* For license information, see LICENSE.txt
*/
// This file was autogenerated by go-to-protobuf. Do not edit it manually!

syntax = "proto2";

package github.com.metaprov.modelaapi.pkg.apis.training.v1alpha1;

import "github.com/metaprov/modelaapi/pkg/apis/catalog/v1alpha1/generated.proto";
import "github.com/metaprov/modelaapi/pkg/apis/data/v1alpha1/generated.proto";
import "k8s.io/api/core/v1/generated.proto";
import "k8s.io/apimachinery/pkg/apis/meta/v1/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/generated.proto";
import "k8s.io/apimachinery/pkg/runtime/schema/generated.proto";

// Package-wide variables from generator "generated".
option go_package = "github.com/metaprov/modelaapi/pkg/apis/training/v1alpha1";

// Define a single custom search spec for a single alg
message AlgorithmParameterRange {
  // The algorithm name
  // +kubebuilder:validation:Optional
  optional string name = 1;

  // Specify one or more parameters ranges. This parameters will override the default
  // ranges
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ParameterRange ranges = 2;
}

// AlgorithmSearchSpaceSpec defines the algorithms available to models produced by a Study
message AlgorithmSearchSpaceSpec {
  // Which algorithm to include
  // If empty, all algorithms will be available for training
  // +kubebuilder:validation:Optional
  repeated string include = 1;

  // Which algorithm to exclude
  // If empty, all algorithms will be available for training
  // +kubebuilder:validation:Optional
  repeated string exclude = 2;

  // Set a custom hyper parameter spaace.
  // Specify custom ranges per estimator.
  // +kubebuilder:validation:Optional
  repeated AlgorithmParameterRange custom = 3;
}

message Anomaly {
  // +kubebuilder:validation:Optional
  optional string name = 1;

  // +kubebuilder:validation:Optional
  optional string valueColumn = 2;

  // +kubebuilder:validation:Optional
  optional string adjDeltaColumn = 3;

  // The start of the anomaly
  // +kubebuilder:validation:Optional
  optional string start = 4;

  // The end of the anomaly
  // +kubebuilder:validation:Optional
  optional string end = 5;
}

// AudioPipelineSpec represents a single pipeline for preprocessing audio data
message AudioPipelineSpec {
  // The date time imputer.
  // +kubebuilder:default:="auto"
  // +kubebuilder:validation:Optional
  optional string featurizer = 1;
}

// BacktestSpec specify the back test
message BacktestSpec {
  // If true, use sliding windows, else use expanding windows
  // +kubebuilder:default = false
  // +kubebuilder:validation:Optional
  optional bool sliding = 1;

  // Number of splits. Default is 5
  // +kubebuilder:default = 5
  // +kubebuilder:validation:Optional
  optional int32 splits = 2;

  // ExpectedValueMax size for a single training set
  // +kubebuilder:default = 0
  // +kubebuilder:validation:Optional
  optional int32 Initial = 3;

  // The number of data points between each windows
  // +kubebuilder:default = 0
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Optional
  optional int32 gap = 5;
}

// BaselineSpec specifies the configuration to produce baseline models
message BaselineSpec {
  // Indicates if baseline models will be produced. Enabling baseline will create a model for each
  // algorithm in the parent ModelClass's search space with default hyper-parameters
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // Baselines contains the collection of algorithms that models will be created with
  // +kubebuilder:validation:Optional
  repeated string baselines = 2;

  // Indicates if models will be created for every algorithm
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool all = 3;
}

message ChangePoint {
}

// ChatbotEstimatorSpec specifies the configuration for a chatbot model
message ChatbotEstimatorSpec {
  // The name of the base model
  // +kubebuilder:validation:Optional
  optional string base = 1;
}

// CheckpointSpec specifies where to store model checkpoints
message CheckpointSpec {
  // Indicates if checkpointing is enabled.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The interval, in minutes, at which a snapshot of a partially trained model will be saved.
  // Applicable to models with long training times for resiliency if training is suddenly stopped
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=10
  // +kubebuilder:validation:Minimum=0
  optional int32 checkpointInterval = 2;

  // The location of the model checkpoint
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation location = 3;
}

// ClassicalEstimatorSpec is the specification for an algorithm and the actual value fof the hyper parameters
message ClassicalEstimatorSpec {
  // AlgorithmName is a reference to the algorithm in the catalog
  optional string algorithmName = 1;

  // Parameters is a list of the algorithm hyper parameters
  repeated HyperParameterValue parameters = 2;
}

message CustomReportSpec {
  // Pages contains a collection of custom pages that will be appended to a Report
  repeated github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.PageSpec pages = 8;
}

// DataHashes contains the hashes for datasets used during model training
message DataHashes {
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string trainHash = 1;

  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string testingHash = 2;

  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string validationHash = 3;
}

// DataSplitSpec specifies the configuration to split a dataset into training and testing datasets
message DataSplitSpec {
  // The type of split method
  // +kubebuilder:default:="auto"
  // +kubebuilder:validation:Optional
  optional string method = 1;

  // The number percentage (0 through 100) of rows that will be allocated to the training dataset
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=80
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:validation:Maximum=100
  optional int32 train = 2;

  // The number percentage (0 through 100) of rows that will be allocated to the validation dataset.
  // If Validation is set to 0 the model will default to use cross-validation
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Maximum=50
  // +kubebuilder:validation:Optional
  optional int32 validation = 3;

  // The number percentage (0 through 100) of rows that will be allocated to the training dataset
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Maximum=100
  // +kubebuilder:default:=20
  // +kubebuilder:validation:Optional
  optional int32 test = 4;

  // The name of the column containing a binary value that indicates if the row should be split.
  // The split type must use split-column in order for SplitColumn to have an effect
  // +kubebuilder:validation:Optional
  optional string splitColumn = 5;

  // The collection of segments
  // +kubebuilder:validation:Optional
  repeated SegmentSpec segments = 6;

  // The name of the Entity resource which will be used as the training dataset
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string trainDataset = 7;

  // The name of the Entity resource which will be used as the testing dataset, applicable
  // if the split type uses test-dataset. If enabled, the training dataset will not be split and used as-is
  // If empty, we will not use test dataset
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string testDataset = 8;

  // The name of the Entity resource which will be used as the validation dataset, applicable
  // if the split type uses test-dataset. If enabled, the training dataset will not be split and used as-is
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string validationDataset = 9;
}

message DeepEstimatorLayer {
  // Name is the name of the layer
  optional string name = 1;

  // Type is the type of the layers
  optional string type = 2;

  // Parameters are the hyper parameters of this layer
  repeated NNLayerParameter parameters = 3;

  // InputLayers are the layer input to this layer
  repeated string inputLayers = 4;
}

message DeepEstimatorSpec {
  // Layers is the dnn architecture
  // +kubebuilder:validation:Optional
  repeated DeepEstimatorLayer layers = 1;

  // The type of the dnn
  // +kubebuilder:validation:Optional
  optional string type = 2;

  // Batch size specify about
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Optional
  optional int32 batchSize = 3;

  // Budget size specify about
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Optional
  optional int32 epochs = 4;

  // ValidationSplit specify about
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Optional
  optional int32 validationSplit = 5;

  // Is this a seq model
  // +kubebuilder:validation:Optional
  optional bool isSeq = 6;

  // Gpus denote of gpu for trainer, any number more than 1 denote distribute training
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Optional
  optional int32 gpus = 7;

  // compile
  // +kubebuilder:validation:Optional
  optional string loss = 8;
}

message DriftDetectorStatus {
  // The location of the prediction outlier detection
  optional string outlierModelURI = 1;
}

// The spec for generating a density model for this ModelClass.
message DriftModelSpec {
  // Indicates if density models should be created.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The density model alg.
  // +kubebuilder:default:="isolation-forest"
  // +kubebuilder:validation:Optional
  optional string outlierAlgorithm = 2;
}

// EarlyStopSpec specifies the configuration to automatically abort a model search
// if further improvements in model performance cannot be produced
message EarlyStopSpec {
  // Indicates if early stopping is enabled
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The number of models to train before model objective metrics will begin to be checked for early stopping
  // +kubebuilder:default:=20
  // +kubebuilder:validation:Optional
  optional int32 initial = 2;

  // The number of models with no improvement in score that are required to abort the model search
  // +kubebuilder:default:=5
  // +kubebuilder:validation:Optional
  optional int32 minModelsWithNoProgress = 3;
}

// EnsembleRules is an algorithm class that decide
message EnsembleRules {
}

// EnsembleSpec specifies the parameters of an ensemble model
message EnsembleSpec {
  // The collection of models (by their name) to be used as estimators in the ensemble
  // +kubebuilder:validation:Optional
  repeated string models = 1;

  // The collection of estimators to be used in the ensemble, derived from Models
  // +kubebuilder:validation:Optional
  repeated ClassicalEstimatorSpec estimators = 2;

  // The base estimator
  // +kubebuilder:validation:Optional
  optional ClassicalEstimatorSpec final = 3;

  // The ensemble type method
  // +kubebuilder:validation:Optional
  optional string type = 4;
}

// EnsemblesSpec specifies the configuration to produce ensemble models
message EnsemblesSpec {
  // Indicates if ensemble models will be created
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // Indicates if a voting ensemble model will be created
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool votingEnsemble = 2;

  // Indicates if a stacking ensemble model will be created
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool stackingEnsemble = 3;

  // The number of top candidate models to include in the ensemble
  // +kubebuilder:default:=3
  // +kubebuilder:validation:Optional
  optional int32 top = 4;
}

message EntityRef {
  // The name of the entity
  optional string name = 1;

  // FeatureGroups to exclude from the link
  // +kubebuilder:validation:Optional
  repeated string exclude = 2;
}

// What metric to evaluate
message EvalMetrics {
  // From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Used to select the optimal model during cross-validation.
  // +kubebuilder:validation:Optional
  optional string selection = 1;

  // From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Additional metrics to compute during CV, besides the one specified by ``cv_selection_metric``
  // +kubebuilder:validation:Optional
  repeated string reporting = 2;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  //  Defines how to aggregate rolling windows of actual and predicted values
  //  before evaluation.
  // +kubebuilder:validation:Optional
  optional string aggFunc = 3;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  //  Number of periods to aggregate before evaluation.
  // +kubebuilder:validation:Optional
  optional int32 aggPeriod = 4;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Defines baseline model to compute ``R2_null_model_score`` evaluation metric.
  // R2_null_model_score is the improvement in the loss function relative
  // to a null model. It can be used to evaluate model quality with respect to
  // a simple baseline
  // +kubebuilder:validation:Optional
  optional string nullModelParams = 5;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Threshold to compute the ``Outside Tolerance`` metric,
  // defined as the fraction of forecasted values whose relative
  // error is strictly greater than ``relative_error_tolerance``.
  // If `NoneSeasonalityMode`, the metric is not computed.
  // +kubebuilder:validation:Optional
  optional double relErrTolerance = 6;
}

// The cross validation spec, used to evaluate the forecaster during training.
message EvalPeriod {
  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Numbers of periods held back from end of df for test.
  // The rest is used for cross validation.
  // If None, default is forecast_horizon. Set to 0 to skip backtest.
  // +kubebuilder:validation:Optional
  optional int32 testHorizon = 1;

  // +kubebuilder:validation:Optional
  optional int32 periodsBetweenTrainTest = 2;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Number of periods to slide the test window between CV splits. Has to be greater than or equal to 1.
  // If None, default is cv_horizon.
  // +kubebuilder:validation:Optional
  optional int32 cvPeriodsBetweenSplits = 3;

  // +kubebuilder:validation:Optional
  optional bool cvExpandingWindows = 4;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Number of periods in each CV test set
  // If None, default is forecast_horizon. Set to 0 to skip CV.
  // +kubebuilder:validation:Optional
  optional int32 cvHorizon = 5;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Minimum number of periods for training each CV fold.
  // If cv_expanding_window is False, every training period is this size
  // If None, default is 2 * cv_horizon
  // +kubebuilder:validation:Optional
  optional int32 cvMinTrainPeriods = 6;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // Maximum number of CV splits.
  // Given the above configuration, samples up to max_splits train/test splits,
  // preferring splits toward the end of available data. If None, uses all splits.
  // +kubebuilder:validation:Optional
  optional int32 cvMaxSplits = 7;

  //  From: https://linkedin.github.io/greykite/docs/0.1.0/html/pages/stepbystep/0400_configuration.html
  // If True, splits from the end of the dataset are used.
  // Else a sampling strategy is applied. Check
  // +kubebuilder:validation:Optional
  optional bool cvUseMostRecentSplits = 8;
}

// FeatureEngineeringPipeline represent a single pipeline to transform a dataset
message FeatureEngineeringPipeline {
  // The name of the pipeline
  // +kubebuilder:validation:Required
  optional string name = 1;

  // The type of data which the pipeline applies to
  // +kubebuilder:validation:Required
  // +required
  optional string datatype = 2;

  // The collection of columns which the pipeline applies to. Each column in the dataset with the
  // data type of the pipeline should be added to the collection of columns
  // +kubebuilder:validation:Optional
  repeated string columns = 3;

  // The imputation method to use, which fills in missing values within the columns
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string imputation = 4;

  // The encoding method to use for categorical data types
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string encoding = 5;

  // The scaling method to use for numerical data types
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string scaling = 6;

  // The discretisation method, which converts numerical data types to discrete variables
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string discretisation = 7;

  // The transformation method to use for numerical data types
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string variableTransformation = 8;

  // The method to use when handling outliers
  // +kubebuilder:default:=none
  // Apply only to numeric data types.
  optional string outlierHandling = 9;

  // The method to use when handling the date-time data type
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string datetimeTransformation = 10;

  // Text specifies the pipeline to handle raw text
  // +kubebuilder:validation:Optional
  optional TextPipelineSpec text = 11;

  // Image specifies the pipeline to handle image data (currently unsupported)
  // +kubebuilder:validation:Optional
  optional ImagePipelineSpec image = 12;

  // Audio specifies the pipeline to handle audio data (currently unsupported)
  // +kubebuilder:validation:Optional
  optional AudioPipelineSpec audio = 13;

  // Video specifies the pipeline to handle video data (currently unsupported)
  // +kubebuilder:validation:Optional
  optional VideoPipelineSpec video = 14;

  // Generated specifies a collection of columns to be generated
  // +kubebuilder:validation:Optional
  repeated GeneratedColumnSpec generated = 16;

  // Custom specifies a collection of columns to be generated. Custom columns are specified by end-users
  // +kubebuilder:validation:Optional
  repeated GeneratedColumnSpec custom = 17;

  // Indicates if all of all the columns specified by the Columns field should be dropped
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool drop = 18;

  // Indicates if the pipeline should not be applied and the columns should remain unchanged
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool passthrough = 19;
}

// FeatureEngineeringSearchSpec specifies the configuration to produce
// the best-performing feature engineering pipeline for a given dataset
message FeatureEngineeringSearchSpec {
  // Indicates if the feature engineering search will be performed
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The method to use when handling an imbalanced dataset
  // +kubebuilder:default:=auto
  // +kubebuilder:validation:Optional
  optional string imbalancedHandler = 2;

  // The algorithm to use when evaluating models with different feature engineering pipelines
  // +kubebuilder:validation:Optional
  optional string estimator = 3;

  // The number of models to sample, after which the feature engineering with the highest
  // score will be used with Model resources produced by the primary model search of the parent ModelClass
  // +kubebuilder:default:=10
  // +kubebuilder:validation:Optional
  optional int32 maxModels = 4;

  // The deadline, in seconds, for models produced by the search to be trained
  // +kubebuilder:default:=3600
  // +kubebuilder:validation:Optional
  optional int32 maxTime = 5;

  // The desired number of trainers that will train candidate models in parallel. The number
  // of trainers is restricted based on the allowance provided by the active License
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 maxTrainers = 6;

  // The number percentage (0 through 100) of the dataset to train models with
  // +kubebuilder:default:=100
  // +kubebuilder:validation:Optional
  optional int32 samplePct = 7;

  // Indicates if models produced by the feature engineering search should be
  // automatically removed at the conclusion of the search
  // +kubebuilder:default:=true
  optional bool autoRemove = 8;

  // If true, if a feature engineering pipeline was previously produced for
  // the same dataset it will be used as a starting point for the search
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool reuse = 9;

  // Specification for feature selection.
  // successful ModelClass.
  // +kubebuilder:validation:Optional
  optional FeatureSelectionSpec feSelection = 10;

  // The number of new models produced by the fe search which, if there is no improvement
  // in score, the model search will conclude
  // +kubebuilder:validation:Optional
  optional EarlyStopSpec earlyStop = 12;
}

message FeatureEngineeringSearchStatus {
  // The recommended pipeline after feature engineering was done
  optional FeatureEngineeringSpec best = 1;
}

// FeatureEngineeringSpec specifies the feature engineering and preprocessing to be performed on a dataset
message FeatureEngineeringSpec {
  // Pipelines contains the collection of feature engineering pipelines that
  // will be applied to a dataset prior to model training
  // +kubebuilder:validation:Optional
  repeated FeatureEngineeringPipeline pipelines = 1;

  // The method which will be used to handle an imbalanced dataset
  // +kubebuilder:default:=auto
  // +kubebuilder:validation:Optional
  optional string imbalance = 2;

  // FeatureSelection specifies the configuration to perform
  // feature selection on a dataset prior to model training
  // +kubebuilder:validation:Optional
  optional FeatureSelectionSpec selection = 3;
}

// FeatureImportance records the computed importance of a single feature
message FeatureImportance {
  // The name of the feature
  optional string feature = 1;

  // The importance of the feature
  // +kubebuilder:validation:Format=float
  // +kubebuilder:validation:Type=number
  optional double importance = 2;
}

message FeatureInfo {
  // The feature name
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string name = 1;

  // The reason that the feature was dropped
  // +kubebuilder:validation:Optional
  optional string reason = 2;

  // +kubebuilder:validation:Optional
  optional double value = 3;
}

message FeaturePair {
  optional string x = 1;

  optional string y = 2;
}

// FeatureSelectionSpec specifies the configuration to run feature selection on a dataset
message FeatureSelectionSpec {
  // Indicates if feature selection is enabled
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // Indicates if embedded methods will be tested as part of the candidate algorithms (e.g. tree-based selection)
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool embedding = 3;

  // Indicates if filter methods will be tested as part of the candidate algorithms (e.g. chi-square or anova tests)
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool filter = 4;

  // Indicates if wrapper methods will be tested as part of the candidate algorithms
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool wrapper = 5;

  // The collection of feature selection methods that will be applied in order to the dataset
  repeated string pipeline = 6;

  // The threshold as a percentage to remove low variance features
  // +kubebuilder:default:=5
  // +kubebuilder:validation:Optional
  optional int32 varThreshold = 7;

  // The threshold to remove features with high correlations
  // +kubebuilder:default:=95
  // +kubebuilder:validation:Optional
  optional int32 corrThreshold = 8;

  // The number of features that will be selected based on importance. If TopN is 0, all features will be selected
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 maxFeatures = 9;

  // Percent of features to keep
  // +kubebuilder:default:=20
  // +kubebuilder:validation:Optional
  optional int32 percentile = 10;

  // List of features that are reserved and will always be included in the final feature selection
  // +kubebuilder:validation:Optional
  repeated string reserved = 12;
}

// The forecaster search define a search for the forecaster
message ForecasterSpec {
  // The spec for the holiday
  // +kubebuilder:validation:Optional
  repeated TimeSeriesEvent events = 2;

  // Specification for the past windows
  // +kubebuilder:validation:Optional
  optional WindowSpec past = 3;

  // Specification for the future windows
  // +kubebuilder:validation:Optional
  optional WindowSpec future = 4;

  // Make a forecast post training
  // +kubebuilder:validation:Optional
  optional bool forecast = 5;

  // Make a forecast post training
  // +kubebuilder:validation:Optional
  optional double coverage = 6;

  // The data location that would store the forecast result.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation outputLocation = 7;

  // List of time series features to compute on each time series.
  // +kubebuilder:validation:Optional
  repeated string features = 8;

  // Filter the groups to forecast for. If none forecast only to the leaf group
  // +kubebuilder:validation:Optional
  repeated string groups = 9;

  // +kubebuilder:validation:Optional
  optional string predefinedTemplate = 10;

  // +kubebuilder:validation:Optional
  repeated Anomaly anomalies = 11;

  // +kubebuilder:validation:Optional
  optional string trainEndData = 12;

  // The value column. this is the name of the column to forecast, this will be based on the data source.
  // +kubebuilder:validation:Optional
  optional string valueColumn = 13;

  // +kubebuilder:validation:Optional
  optional int32 hpoBudget = 14;

  // Spec for evaluation metric
  // +kubebuilder:validation:Optional
  optional EvalMetrics evaluationMetrics = 15;

  // Spec for time series cross validation
  // +kubebuilder:validation:Optional
  optional EvalPeriod evaluationPeriod = 16;

  // +kubebuilder:validation:Optional
  optional SeasonalitySpec seasonality = 17;

  // The regressor. Initially those are set from the data source schema
  // +kubebuilder:validation:Optional
  repeated string regressors = 18;

  // Lagged Regressors
  // +kubebuilder:validation:Optional
  repeated string laggedRegressors = 19;

  // Set the growth of the series
  // +kubebuilder:validation:Optional
  optional string growth = 20;

  // In case of group forecast
  // +kubebuilder:validation:Optional
  repeated string key = 21;

  // The estimators to try. By default, we try graykit / auto arima and prophet.
  // +kubebuilder:validation:Optional
  repeated string estimators = 22;

  // Group recocile.
  // By default this is the bottom-up
  // +kubebuilder:default:="bottom-up"
  // +kubebuilder:validation:Optional
  optional string hts = 23;
}

// GarbageCollectionSpec specifies the configuration to garbage-collect unused Model resources
message GarbageCollectionSpec {
  // Indicates if all models of the ModelClass, excluding the highest-performing model, will be archived
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=true
  optional bool collectAtModelClassEnd = 1;

  // Indicates if multiple models with the same algorithm are produced by the ModelClass, the
  // model with the lowest score will be garbage-collected
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=false
  optional bool keepOnlyBestModelPerAlgorithm = 2;

  // Indicates if we should keep pruned models
  // model with the lowest score will be garbage-collected
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=false
  optional bool keepPrunedModels = 3;
}

// GarbageCollectionStatus contains the records for garbage-collected models
message GarbageCollectionStatus {
  // The number of models that were collected, equal to len(Models)
  // +kubebuilder:validation:Optional
  optional int32 collectedModelsCount = 1;

  // The collection of models that were archived
  // +kubebuilder:validation:Optional
  repeated ModelResult models = 2;
}

// GeneratedColumnSpec describes a column to be generated and applied to a dataset
message GeneratedColumnSpec {
  // The name of the generated column
  optional string name = 1;

  // The resulting data type
  optional string datatype = 2;

  // The name of the first original column
  optional string first = 3;

  // The name of the second original column, if the expression is binary operator
  // +kubebuilder:validation:Optional
  optional string second = 4;

  // The expression to apply in order to generate the new column
  // +kubebuilder:validation:Optional
  optional string original = 5;
}

message GroupSplitLocationsSpec {
  // The folder of group data
  // +kubebuilder:validation:Optional
  optional string groupTrainingDataFile = 1;

  // The folder of group data
  // +kubebuilder:validation:Optional
  optional string groupTestingDataFile = 2;
}

// HyperParameterValue represent an individual hyper-parameter of a machine earning algorithm
message HyperParameterValue {
  // The name of the hyper-parameter
  optional string name = 1;

  // The value of the hyper-parameter
  optional string value = 2;
}

message HyperbandOptions {
  // A parameter for specifying the minimum resource allocated to a trial noted as 𝑟 in the paper
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 minResources = 1;

  // A parameter for specifying the maximum resource allocated to a trial
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 maxResources = 2;

  // A parameter for specifying reduction factor of promotable trials
  // +kubebuilder:default:=3
  // +kubebuilder:validation:Optional
  optional int32 reductionFactor = 3;

  // Parameter specifying the number of trials required in a rung before any trial can be promoted
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 bootstrapCount = 4;
}

// ImagePipelineSpec represents a single pipeline for preprocessing image data
message ImagePipelineSpec {
  // The date time imputer.
  // +kubebuilder:default:="auto"
  // +kubebuilder:validation:Optional
  optional string featurizer = 1;
}

// ImbalanceHandlingSpec specifies the configuration to process an imbalanced dataset
message ImbalanceHandlingSpec {
  // Indicates if imbalance handling is enabled
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The technique that will be used to handle the imbalanced dataset
  // +kubebuilder:default:=auto
  // +kubebuilder:validation:Optional
  optional string imbalance = 2;
}

// InterpretabilitySpec specifies the configuration to generate interpretability data and diagrams
message InterpretabilitySpec {
  // Indicates if ICE (individual condition expectation) plots will be generated
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool ice = 1;

  // The collection of feature pairs to generate ICE scatter diagrams for each
  repeated FeaturePair icepairs = 2;

  // Indicates if LIME (local interpretable model-agnostic explanations) diagrams will be generated
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool lime = 3;

  // The type of SHAP values to be generated. Linear and tree values are the
  // only recommended types due to the high compute times of other methods
  // +kubebuilder:default:=auto
  // +kubebuilder:validation:Optional
  optional string shap = 4;

  // The collection of feature pairs to generate SHAP scatter diagrams for each
  // +kubebuilder:validation:Optional
  repeated FeaturePair shappairs = 5;

  // Indicates if counter-factual diagrams will be generated
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool counterfactual = 6;

  // Indicates if anchor explanation diagrams will be generated
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool anchor = 7;
}

// InterpretabilityStatus represents the state of the explanation phase of a Model
message InterpretabilityStatus {
  // StartedAt represents the time when the model explanation phase started
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time startedAt = 1;

  // CompletedAt represents the time when the model explanation phase ended
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 2;

  // The URI for the generated explanation data
  optional string explainerURI = 3;

  // The URI for the train SHAP values
  optional string trainShapValuesURI = 4;

  // The URI for the test SHAP values
  optional string testShapValuesURI = 5;

  // The collection of feature importances generated from the computed SHAP values
  repeated FeatureImportance importance = 6;
}

message Level {
  // The level name, must be unique
  optional string name = 1;

  // The key for the levels
  repeated string index = 2;

  // The forecast horizon
  optional int32 horizon = 3;

  // The freq of the level
  optional string freq = 4;

  // The aggregate function used to roll up the lower level
  optional string aggregate = 5;
}

message MedianPrunerOptions {
  // Pruning is disabled until the given number of trials finish in the same ModelClass.
  // +kubebuilder:default:=5
  // +kubebuilder:validation:Optional
  optional int32 startupTrials = 1;

  //  Pruning is disabled until the trial exceeds the given number of step
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 warmupSteps = 2;

  // Interval in number of steps between the pruning checks
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 intervalSteps = 3;

  // Minimum number of reported trials.
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 minTrials = 4;
}

// +kubebuilder:object:root=true
// +kubebuilder:resource:path=models,singular=model,shortName=md,categories={training,modela,all}
// +kubebuilder:subresource:status
// +kubebuilder:storageversion
// +kubebuilder:printcolumn:name="Status",type="string",JSONPath=".status.phase"
// +kubebuilder:printcolumn:name="Progress",type="string",JSONPath=".status.progress",priority=1
// +kubebuilder:printcolumn:name="Best",type="boolean",JSONPath=".status.best"
// +kubebuilder:printcolumn:name="Owner",type="string",JSONPath=".spec.owner",priority=1
// +kubebuilder:printcolumn:name="Version",type="string",JSONPath=".spec.versionName",priority=1
// +kubebuilder:printcolumn:name="Study",type="string",JSONPath=".spec.studyName"
// +kubebuilder:printcolumn:name="Task",type="string",JSONPath=".spec.task",priority=1
// +kubebuilder:printcolumn:name="Algorithm",type="string",JSONPath=".spec.estimator.algorithmName"
// +kubebuilder:printcolumn:name="Objective",type="string",JSONPath=".spec.objective.metric"
// +kubebuilder:printcolumn:name="CV Score",type="number",JSONPath=".status.cvScore"
// +kubebuilder:printcolumn:name="Train Score",type="number",JSONPath=".status.trainScore",priority=1
// +kubebuilder:printcolumn:name="Test Score",type="number",JSONPath=".status.testScore"
// +kubebuilder:printcolumn:name="Last Failure",type="string",JSONPath=".status.failureMessage",priority=1
// +kubebuilder:printcolumn:name="Age",type="date",JSONPath=".metadata.creationTimestamp"
// Model represents a machine learning model that will be trained, evaluated, and deployed by Modela.
// Model resources are generated by the Modela data plane and cannot be created manually
message Model {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ModelSpec spec = 2;

  // +optional
  optional ModelStatus status = 3;
}

// +kubebuilder:subresource:status
// +kubebuilder:resource:path=modelclasses,singular=modelclass,shortName=mc,categories={training,modela}
// +kubebuilder:object:root=true
// +kubebuilder:storageversion
// +kubebuilder:printcolumn:name="Owner",type="string",JSONPath=".spec.owner",priority=1
// +kubebuilder:printcolumn:name="Version",type="string",JSONPath=".spec.versionName",priority=1
// +kubebuilder:printcolumn:name="Description",type="string",JSONPath=".spec.description"
// +kubebuilder:printcolumn:name="Task",type="string",JSONPath=".spec.task"
// +kubebuilder:printcolumn:name="Objective",type="string",JSONPath=".spec.objective.metric"
// +kubebuilder:printcolumn:name="Age",type="date",JSONPath=".metadata.creationTimestamp"
// ModelClass represents an automatic search for the best machine learning model for a given dataset
message ModelClass {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ModelClassSpec spec = 2;

  // +optional
  optional ModelClassStatus status = 3;
}

// Specification for the label information
message ModelClassDataSpec {
  // The location of the observation file or table.
  // The observations are the source for training (observations which have a value for the target
  // columns) or for prediction (observations with no targets).
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation observations = 1;

  // The location of the predictions table. The predictions table contains all the latest predictions.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation predictions = 2;

  // The schema of the observation file. The schema is used as the basis for training and serving.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.Schema schema = 3;

  // In case where the feature group data is stored as flat file. the flat file format
  // define how to read the file.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.FlatFileFormatSpec flatFile = 4;

  // The primary key for the observation row
  // If empty the system will set the join key as the primary key based on the schema.
  // +kubebuilder:validation:Optional
  repeated string primaryKey = 5;

  // Define the column name that contains the prediction time for each row in the label data.
  // The system uses the prediction time in order to avoid data leakage.
  // I.e. the training dataset will contain only data that was known before the prediction time
  // If null, the system will set the prediction time column as the time index column in the schema.
  // +kubebuilder:validation:Optional
  optional string predictionTimeColumn = 6;

  // Name of the target column
  // If null, the system will assign this column based on the schema.
  // +kubebuilder:validation:Optional
  optional string target = 7;

  // Tests to run on the training data before training. This assurs data quality is being met.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite tests = 8;

  // The name of the online feature store that serve predictions for models from this model class
  // The offline feature stores are stored in the tenant.
  // +kubebuilder:validation:Optional
  optional string onlineFeatureStoreName = 9;

  // The name of the offline feature store, the offline feature store contain the observations and the feature groups
  // The offline feature stores are stored in the tenant.
  // +kubebuilder:validation:Optional
  optional string offlineFeatureStoreName = 10;
}

// ModelClassList contains a list of Studies
// +kubebuilder:object:root= true
message ModelClassList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated ModelClass items = 2;
}

// +kubebuilder:object:root=true
// +kubebuilder:resource:path=modelclassruns,shortName=mcr,singular=modelclassrun,categories={train,modela,all}
// +kubebuilder:subresource:status
// +kubebuilder:storageversion
// +kubebuilder:printcolumn:name="Status",type="string",JSONPath=".status.phase"
// +kubebuilder:printcolumn:name="ModelClass",type="string",JSONPath=".spec.modelClassName"
// +kubebuilder:printcolumn:name="CompletedAt",type="date",JSONPath=".status.completionTime",priority=1
// +kubebuilder:printcolumn:name="Last Failure",type="string",JSONPath=".status.failureMessage"
// +kubebuilder:printcolumn:name="Age",type="date",JSONPath=".metadata.creationTimestamp"
// ModelClassRun represent a execution of a model class training
message ModelClassRun {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ModelClassRunSpec spec = 2;

  // +optional
  optional ModelClassRunStatus status = 3;
}

// +kubebuilder:object:root=true
// ModelClassRunList represent list of pipelineruns
message ModelClassRunList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated ModelClassRun items = 2;
}

// ModelClassRunSpec is the desired state of the ModelClassRun resource
message ModelClassRunSpec {
  // VersionName is the data product version of the run
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string versionName = 1;

  // Description is the user provided description
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string description = 2;

  // DatasetName is the name of the dataset that we trained on.
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string datasetName = 3;

  // ModelClassName is the name of the ModelClass for this pipeline
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string modelClassName = 4;

  // The owner of the run.
  // +kubebuilder:default:="no-one"
  // +kubebuilder:validation:Optional
  optional string owner = 5;

  // The priority of this pipeline run. The default is medium.
  // +kubebuilder:default:=medium
  // +kubebuilder:validation:Optional
  optional string priority = 6;

  // Set to true to pause the model pipeline run
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool paused = 7;

  // Set to true to abort the model pipeline run
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool aborted = 8;

  // TTL.
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 ttl = 9;

  // What triggered the run
  // +kubebuilder:validation:Optional
  optional string triggeredBy = 10;
}

// ModelClassRunStatus is the observed state of the ModelClassRun resource .
message ModelClassRunStatus {
  // The name of the dataset that was captured by the label filter.
  // +kubebuilder:validation:Optional
  optional string datasetName = 1;

  // The name of the study generated.
  // +kubebuilder:validation:Optional
  optional string studyName = 2;

  // The name of the best model
  // +kubebuilder:validation:Optional
  optional string modelName = 3;

  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 5;

  // The phase of the pipeline run
  // +kubebuilder:default:="Pending"
  // +kubebuilder:validation:Optional
  optional string phase = 6;

  // ObservedGeneration is the Last generation that was acted on
  // +kubebuilder:validation:Optional
  optional int64 observedGeneration = 7;

  // Folder for pipeline run artifacts. This is assigned by the system
  // The folder contains all the pipeline artifacts - metadata, logs
  // +kubebuilder:validation:Optional
  optional string evalMetrics = 8;

  // UpdateUpdateStrategy in case of terminal failure
  // Borrowed from cluster api controller
  // +kubebuilder:validation:Optional
  optional string failureReason = 9;

  // UpdateUpdateStrategy in case of terminal failure message
  // +kubebuilder:validation:Optional
  optional string failureMessage = 10;

  // Last time the object was updated
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time updatedAt = 12;

  // The log file specification that determines the location of all logs produced by the object
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Logs logs = 13;

  // Last promotion was done
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time promotedAt = 14;

  // If true the promotion was automatic
  optional bool auto = 15;

  // for manual promotion, who approved the promotion
  optional k8s.io.api.core.v1.ObjectReference approvedBy = 16;

  // for manual promotion, who approved the promotion
  optional int32 modelsCount = 17;

  // +patchMergeKey=type
  // +patchStrategy=merge
  // +kubebuilder:validation:Optional
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.Condition conditions = 18;
}

message ModelClassServingSpec {
  // Define the stages to test the model before release
  // +kubebuilder:validation:Optional
  repeated PipelineStageSpec pipeline = 1;

  // The name of the predictor template to use when
  // +kubebuilder:validation:Optional
  optional string predictorTemplateName = 2;

  // The reference to the serving site, where online predictor will be served.
  // If unspecified, the default Lab from the parent DataProduct will be used
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference servingSiteRef = 3;

  // Create an online predictor, if the model is used only for batch prediction, set this option to false.
  // +kubebuilder:validation:Optional
  optional bool online = 4;

  // Setup a dashboard for the predictor.
  // +kubebuilder:validation:Optional
  optional bool dashboard = 5;

  // Access specifies the configuration for the Predictor service to be exposed externally
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.AccessSpec access = 6;

  // The number of replicas for the Kubernetes Serving associated with the Predictor, which will instantiate multiple
  // copies of the service in the case that automatic scaling is disabled
  // +kubebuilder:validation:Optional
  optional int32 replicas = 7;

  // Schedule for computing drift
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunSchedule monitoringSchedule = 8;

  // BatchPrediction schedule
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunSchedule predictionSchedule = 9;

  // The serving resources for batch or online prediction
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 10;

  // when a model is ready, deploy it as shadow model first.
  // +kubebuilder:validation:Optional
  optional bool shadowFirst = 11;

  // List of SQL statements to run before performing the prediction
  // +kubebuilder:validation:Optional
  repeated string preSQL = 12;

  // List of SQL statements to run before performing the prediction
  // +kubebuilder:validation:Optional
  repeated string postSQL = 13;
}

// ModelClassSpec defines the desired state of a ModelClass and the parameters for a model search
message ModelClassSpec {
  // The name of the Account which created the object, which exists in the same tenant as the object
  // +kubebuilder:default:="no-one"
  // +kubebuilder:validation:Optional
  optional string owner = 1;

  // The name of the DataProductVersion which describes the version of the resource
  // that exists in the same DataProduct namespace as the resource
  // +kubebuilder:validation:MaxLength=63
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string dataProductVersionName = 2;

  // The current version of the model class
  // that exists in the same DataProduct namespace as the resource
  // +kubebuilder:validation:Optional
  optional string version = 3;

  // The user-provided description of the ModelClass
  // +kubebuilder:default:=""
  // +kubebuilder:validation:MaxLength=512
  // +kubebuilder:validation:Optional
  optional string description = 4;

  // The machine learning task type (i.e. regression, classification)
  // +kubebuilder:validation:Required
  // +required
  optional string task = 5;

  // The machine learning subtask relevant to the primary task (text classification, image object detection, etc.)
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string subtask = 6;

  // The optimization objective. The objective is also used when promoting models
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ObjectiveSpec objective = 7;

  // If using the feature store (pre defined features), specify the feature groups the would
  // be used to create the training data.
  // +kubebuilder:validation:Optional
  repeated EntityRef entities = 8;

  // The model class data
  // +kubebuilder:validation:Optional
  optional ModelClassDataSpec data = 10;

  // TrainingTemplate specifies the configuration to train and evaluate models
  // +kubebuilder:validation:Optional
  optional ModelClassTrainingSpec training = 11;

  // ServingTemplate specifies the model format and resource requirements that will be applied to
  // the Predictor created for the Model that will be selected by the ModelClass
  // +kubebuilder:validation:Optional
  optional ModelClassServingSpec serving = 12;

  // The notification specification that determines which notifiers will receive Alerts generated by the object
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.NotificationSpec notification = 13;

  // The schedule for summary report
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunSchedule reportSchedule = 14;

  // Fast indicates if Dataset, Model and Study resources associated with the ModelClass should run in fast mode.
  // Running in fast mode will skip unnecessary workloads such as profiling, reporting, explaining, etc.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool fast = 15;

  // If true, pause the model class activities.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool paused = 16;
}

message ModelClassStatus {
  // ObservedGeneration is the last generation that was acted on
  // +kubebuilder:validation:Optional
  optional int64 observedGeneration = 1;

  // The last time the object was updated
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time updatedAt = 2;

  // BestFE specifies the best feature engineering pipeline produced by the ModelClass
  // +kubebuilder:validation:Optional
  optional FeatureEngineeringSpec bestFE = 3;

  // Training schedule status
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunScheduleStatus trainingScheduleStatus = 4;

  // Batch Prediction schedule
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunScheduleStatus predictionSceduleStatus = 5;

  // Batch Prediction schedule
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunScheduleStatus monitoringSceduleStatus = 6;

  // Batch Prediction schedule
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunScheduleStatus reportSceduleStatus = 7;

  // The highest score out of all ModelsCount created by the associated Study resource
  // +kubebuilder:validation:Optional
  optional double bestModelScore = 8;

  // List of the last 5 retired models
  repeated string retired = 9;

  // The name of the current predictor for this model class.
  optional string predictorName = 10;

  // The name of the current dataaoo for the model class
  optional string dataAppName = 11;

  // The name of triggered by.
  // +kubebuilder:validation:Optional
  optional string triggeredBy = 12;

  // UpdateUpdateStrategy in case of terminal failure
  // Borrowed from cluster api controller
  // +kubebuilder:validation:Optional
  optional string failureReason = 13;

  // UpdateUpdateStrategy in case of terminal failure message
  // +kubebuilder:validation:Optional
  optional string failureMessage = 14;

  // The last time a new model was trained as part of this model class
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time lastRunAt = 15;

  // The name of the last prediction for this class
  // +kubebuilder:validation:Optional
  optional string lastRunName = 16;

  // The last time a batch prediction was made
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time lastPredictionAt = 17;

  // The name of the last prediction for this class
  // +kubebuilder:validation:Optional
  optional string lastPredictionName = 18;

  // Total number of batch predictions
  // +kubebuilder:validation:Optional
  optional int32 predictionsCount = 19;

  // Total number of batch  mode class run in the system for this model class.
  // +kubebuilder:validation:Optional
  optional int32 runsCount = 20;

  // Total models in the system for this model class
  // +kubebuilder:validation:Optional
  optional int32 modelsCount = 21;

  // If true, a model of this class is in production
  // +kubebuilder:validation:Optional
  optional bool live = 22;

  // Total predictors in the system for this model class
  // +kubebuilder:validation:Optional
  optional int32 predictorsCount = 23;

  // +optional
  // +patchMergeKey=type
  // +patchStrategy=merge
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.Condition conditions = 24;
}

// Specification for model training.
message ModelClassTrainingSpec {
  // The reference to the Lab under which the Model for the class will be trained
  // If unspecified, the default Lab from the parent DataProduct will be used
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference labRef = 1;

  // Define a reference to a study template. The study template will be the basis for training models
  // From this model class.
  // +kubebuilder:validation:Optional
  optional string studyTemplateName = 2;

  // A template for models unit tests
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite modelUnitTests = 3;

  // Training schedule
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RunSchedule trainingSchedule = 4;

  // ModelImage specifies the configuration to upload Docker images of models to an image registry
  // +kubebuilder:validation:Optional
  optional ModelImageSpec modelImage = 5;

  // Promotion defines the way to promote models
  // +kubebuilder:validation:Optional
  optional string promotionPolicy = 6;

  // Define custom search space for this model class.
  // The search space defines which algorithm to include or execlude
  // If not defined, we would use the search space in the model template.
  // +kubebuilder:validation:Optional
  optional AlgorithmSearchSpaceSpec searchSpace = 8;

  // Training resources
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 9;

  // What triggered the training
  // +kubebuilder:validation:Optional
  optional string triggeredBy = 10;

  // Pause the training job or any additional training job
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool paused = 11;

  // The deadline for models to complete training, in seconds
  // +kubebuilder:validation:Maximum=36000
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:default:=3600
  // +kubebuilder:validation:Optional
  optional int32 maxTime = 12;

  // The number of candidate models that will be sampled and trained
  // +kubebuilder:validation:Maximum=512
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:default:=10
  // +kubebuilder:validation:Optional
  optional int32 maxModels = 13;

  // The desired number of trainers that will train candidate models in parallel. The number
  // of trainers is restricted based on the allowance provided by the active License
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 trainers = 14;

  // Aborted indicates that the execution.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool aborted = 15;

  // Explained indicates that we want to explain models.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool explained = 16;

  // List of SQL statements to run before performing the prediction
  // +kubebuilder:validation:Optional
  repeated string preSQL = 17;

  // List of SQL statements to run before performing the prediction
  // +kubebuilder:validation:Optional
  repeated string postSQL = 18;
}

message ModelGroupByStatus {
  // The locations of the datasets profile files. Each file is the group
  // +kubebuilder:validation:Optional
  optional string modelsURI = 1;

  // The locations of the datasets profiles files.
  // +kubebuilder:validation:Optional
  optional string profilesURI = 2;

  // The locations of forecasts
  // +kubebuilder:validation:Optional
  optional string forecastsURI = 3;

  // Holds the worker on going result, when a worker finish, we update the location of thier result files
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.WorkerRunResult workerResults = 4;
}

// ModelImageSpec specifies the destination of Docker images produced by a ModelClass
message ModelImageSpec {
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=false
  optional bool exist = 1;

  // The full name of the image to upload to
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string imageName = 2;

  // The name of the Connection resource to an external Docker image registry
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string registryConnectionName = 3;
}

// +kubebuilder:object:root=true
// ModelList is a list of ModelsCount
message ModelList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Model items = 2;
}

// ModelResult contains the records of a single garbage-collected model
message ModelResult {
  // The name of the model
  // +kubebuilder:validation:Optional
  optional string name = 1;

  // The type of estimator of the model
  // +kubebuilder:validation:Optional
  optional string alg = 2;

  // The objective score of the model
  // +kubebuilder:validation:Optional
  optional double score = 3;

  // Indicates if the model experience an error whilst training
  // +kubebuilder:validation:Optional
  optional bool error = 4;

  // The optimizer trial ID of the model
  // +kubebuilder:validation:Optional
  optional int32 trialID = 5;
}

// ModelSpec defines the desired state of the Model resource
message ModelSpec {
  // The Account which owns the the Study that created the Model
  // +kubebuilder:default:="no-one"
  // +kubebuilder:validation:Optional
  optional string owner = 1;

  // The name of the DataProductVersion which describes the version of the resource
  // that exists in the same DataProduct namespace as the resource, derived from the parent Study
  // +kubebuilder:validation:Required
  // +kubebuilder:default:="latest"
  // +kubebuilder:validation:MaxLength=63
  // +required
  optional string versionName = 2;

  // The user-assigned version of the Model, derived from the parent Study
  // +kubebuilder:default:=""
  optional string modelVersion = 4;

  // The name of the Study which created the Model. If empty, the Model will be trained as a stand-alone model
  // +kubebuilder:validation:Required
  // +kubebuilder:validation:MaxLength=63
  // +required
  optional string studyName = 5;

  // The name of the Entity resource which the Model is being trained with
  // +kubebuilder:validation:Required
  // +kubebuilder:validation:MaxLength=63
  // +required
  optional string datasetName = 6;

  // The machine learning task type of the Model (i.e. regression, classification), derived from the parent Study
  // +kubebuilder:validation:Required
  // +required
  optional string task = 7;

  // The sub task
  // +kubebuilder:default:="none"
  // +kubebuilder:validation:Optional
  optional string subtask = 8;

  // The objective metric that will be used to evaluate the performance of the model
  // +kubebuilder:validation:Required
  // +required
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ObjectiveSpec objective = 9;

  // FeatureEngineering specifies the preprocessing pipelines that will be applied to the model prior to training.
  // By default, feature engineering is generated automatically by sampling different pipelines in competition
  // +kubebuilder:validation:Optional
  optional FeatureEngineeringSpec featureEngineering = 10;

  // Estimator specifies the machine learning algorithm and hyper-parameters of the Model
  // +kubebuilder:validation:Optional
  optional ClassicalEstimatorSpec estimator = 11;

  // Dnn specifies the estimator for a neural network (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional DeepEstimatorSpec dnn = 12;

  // Chatbot specifies the estimator for a chatbot model (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional ChatbotEstimatorSpec chatbot = 13;

  // NLPEstimator specifies the estimator for a deep NLP model (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional NLPEstimatorSpec nlpEstimator = 14;

  // Ensemble specifies the configuration to create an ensemble model
  // +kubebuilder:validation:Optional
  optional EnsembleSpec ensemble = 15;

  // TrainingSpec specifies the configuration to prepare and train a model
  // +kubebuilder:validation:Optional
  optional TrainingSpec training = 16;

  // ServingSpec defines the resource requirements that will be applied to a Predictor
  // that will be created if the model is set to be released
  // +kubebuilder:validation:Optional
  optional ServingSpec serving = 17;

  // Tested indicates if a workload will be instantiated to test the model. The Study resource controller
  // will automatically set this field if the Model was found to be the highest-performing
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool tested = 18;

  // Aborted indicates if any workloads associated with the Model should stop execution
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool aborted = 19;

  // Packaged indicates if the Model should be packaged into tarbell
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool packaged = 20;

  // Published indicates that the Model should be baked into a Docker image
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool published = 21;

  // Pushed indicates that the Model image should be pushed to a Docker image registry
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool pushed = 22;

  // Reported indicates that a Report will be generated for the Model
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool reported = 23;

  // Paused indicates that the execution of new workloads associated with the Model should be paused
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool paused = 24;

  // Profiled indicates that the Model will be profiled
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool profiled = 25;

  // Archived indicates that the Model should be archived in long-term storage
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool archived = 26;

  // Forecasted indicates that the Model should perform a forecast
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool forecasted = 27;

  // Released indicates that the Model will be deployed within Predictor
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool released = 28;

  // Registered indicate if this model is registered with the model registry.
  // A registred model cannot be garbage collected, and apper in the model registry page.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool registered = 29;

  // Perform a prediction at the end of the study. This is for example apply to forecasting.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool predict = 30;

  // If true perform a final search after selecting the best model. to tune only this model.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool tuned = 31;

  // Explained indicates if a workload to compute SHAP values/diagrams should be executed
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool explained = 32;

  // Not implemented. For future use. If true,generate code when model trained
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool codeGenerated = 33;

  // Baseline indicates if the Model was produced by the baseline phase of a Study
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool baseline = 34;

  // GenDriftDetector indicates if we should generate a drift detector model for this model
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool genDriftDetector = 35;

  // Fast indicates if the Model should skip profiling, explaining, and reporting
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool fast = 36;

  // Indicate if this model should be unit tested.
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool unitTested = 37;

  // The reference to the lated feedback dataset
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference feedbackDatasetRef = 38;

  // Indicates if the model is flagged
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool flagged = 39;

  // The data location where artifacts (metadata, reports, and estimators) generated by the Model will be stored
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation location = 40;

  // Forecasting specifies the configuration to train a forecasting model
  // +kubebuilder:validation:Optional
  optional ForecasterSpec forecasting = 41;

  // Compilation specifies the configuration to compile a model to a binary (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.CompilerSpec compilation = 42;

  // The deadline for any Jobs associated with the Model to be completed in seconds
  // +kubebuilder:default:=600
  // +kubebuilder:validation:Optional
  optional int64 activeDeadlineSeconds = 43;

  // ModelType is the type of model for this estimator
  // +kubebuilder:default:=classical
  // +kubebuilder:validation:Optional
  optional string estimatorType = 44;

  // The time-to-live of the Model, after which the Model will be archived
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 ttl = 45;

  // The model class, which is derived from the phase of the Study that the Model was created for
  // +kubebuilder:validation:Optional
  optional string modelClass = 46;

  // The trial ID, which is incremented for each Model produced by the data plane
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 trialID = 47;

  // Governance specifies the model governance requirements (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.GovernanceSpec governance = 48;

  // Interpretability specifies the configuration to generate model interpretability visualizations
  // +kubebuilder:validation:Optional
  optional InterpretabilitySpec interpretability = 49;

  // The set of unit tests for this model.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite unitTests = 50;

  // The set of unit tests to test this models against the feedback.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite feedbackTests = 51;

  // The set locations in case of group forecasts
  // +kubebuilder:validation:Optional
  optional PartitionModelLocationsSpec partitionLocations = 52;

  // The model class for this model if the model was created by a model class
  // +kubebuilder:validation:Optional
  optional string modelClassName = 53;

  // If this model was created by a model class run, this is the run name
  // +kubebuilder:validation:Optional
  optional string modelClassRunName = 54;

  // The desired role of the model
  // +kubebuilder:default:="none"
  // +kubebuilder:validation:Optional
  optional string role = 55;

  // The serving site that this model is released to
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference servingSiteRef = 56;
}

message ModelStageStatus {
  // Phase is the phase of the stage
  // +kubebuilder:default:="Pending"
  // +kubebuilder:validation:Optional
  optional string phase = 1;

  // Approved indicates that the stage is approved.
  // +kubebuilder:validation:Optional
  optional bool approved = 2;

  // ApprovedBy indicates the account that approve this model.
  // +kubebuilder:validation:Optional
  optional string approvedBy = 3;

  // ApprovedAt indicates the time of approval
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time approvedAt = 4;

  // Start time is the start time of the stage
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time startedAt = 7;

  // End time is the end time of the stage.
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 8;

  // Results is the results of running the test datasets against the new model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuiteResult unitTestsResult = 9;

  // Error record error.
  // +kubebuilder:validation:Optional
  optional string error = 10;
}

// ModelStatus defines the observed state of a Model
message ModelStatus {
  // TrainStartTime represents the time at which the Model started training
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time trainingStartedAt = 2;

  // TrainCompletionTime represents the time at which the Model completed training
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time trainingCompletedAt = 3;

  // TestingStartedAt represents the time at which the Model started testing
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time testingStartedAt = 4;

  // TestingCompletedAt represents the time at which the Model completed testing
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time testingCompletedAt = 5;

  // TuningStartedAt represents the time at which the Model started testing
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time tuningStartedAt = 6;

  // TuningCompletedAt represents the time at which the Model completed testing
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time tuningCompletedAt = 7;

  // CompletedAt represents the time at which the Model was marked as ready, failed, or aborted
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 8;

  // The cross-validation score for the objective metric produced after training
  // +kubebuilder:validation:Optional
  optional double cvScore = 9;

  // The score for the objective metric based on the training dataset
  // +kubebuilder:validation:Optional
  optional double trainingScore = 10;

  // The score for the objective metric based on the testing dataset
  // +kubebuilder:validation:Optional
  optional double testScore = 11;

  // Cost is the cost of training the model in the case of a deep-learning model
  // +kubebuilder:validation:Optional
  optional double cost = 12;

  // Best indicates if the Model was found to be the best model produced by a Study
  // +kubebuilder:validation:Optional
  optional bool best = 13;

  // CV contains the collection of measurements produced by cross-validation
  // on the training dataset or validation on the validation dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Measurement cv = 14;

  // Train contains the collection of measurements produced by validation on the training dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Measurement train = 15;

  // Train contains the collection of measurements produced by validation on the testing dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Measurement test = 16;

  // Tune contains the collection of measurements produced by validation on the tune dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Measurement tune = 17;

  // Feedback contain the collection of measurements produced by running dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Measurement feedback = 18;

  // The last feedback dataset
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference lastFeedbackDatasetRef = 19;

  // The phase of the Model
  // +kubebuilder:default:="Pending"
  // +kubebuilder:validation:Optional
  optional string phase = 20;

  // The name of the Report resource produced by the Model
  // +kubebuilder:validation:Optional
  optional string reportName = 21;

  // The URI of the Report
  // +kubebuilder:validation:Optional
  optional string reportURI = 22;

  // The URI of the Model manifest
  // +kubebuilder:validation:Optional
  optional string manifestURI = 23;

  // The URI of the model test weights
  // +kubebuilder:validation:Optional
  optional string trainWeightsURI = 24;

  // The URI of the model test weights
  // +kubebuilder:validation:Optional
  optional string testWeightsURI = 25;

  // The URI of the model test weights
  // +kubebuilder:validation:Optional
  optional string fullWeightsURI = 26;

  // The URI of the model test weights
  // +kubebuilder:validation:Optional
  optional string driftDetectorURI = 27;

  // Label encoder that was trained on train data during cross validation
  // The URI of the label encoder binary file, if it exists
  // +kubebuilder:validation:Optional
  optional string trainLabelEncoderURI = 28;

  // Label encoder that was trained on train data and tested on the test data
  // The URI of the label encoder binary file, if it exists
  // +kubebuilder:validation:Optional
  optional string testLabelEncoderURI = 29;

  // Label encoder that was trained on the full data
  // The URI of the label encoder binary file, if it exists
  // +kubebuilder:validation:Optional
  optional string fullLabelEncoderURI = 30;

  // The URI of the logs file
  // +kubebuilder:validation:Optional
  optional string logsURI = 31;

  // The URI of the model profile, which contains visualizations produced during the profiling phase
  // +kubebuilder:validation:Optional
  optional string profileURI = 32;

  // The URI to the misclassification file produced during the testing phase
  // +kubebuilder:validation:Optional
  optional string misclassificationURI = 33;

  // The URI to the model tarbell file
  // +kubebuilder:validation:Optional
  optional string tarURI = 34;

  // The URI to the model application file
  // +kubebuilder:validation:Optional
  optional string appURI = 35;

  // The name of the Docker image produced by the Model
  // +kubebuilder:validation:Optional
  optional string imageName = 36;

  // The collection of features and their importance, sorted by the greatest importance first
  // The collection is measured based on impuriry and uses the native measures by a tree algorithm
  // +kubebuilder:validation:Optional
  repeated FeatureImportance impurityImportance = 37;

  // The collection of features and their importance, sorted by the greatest importance first
  // The collection is measured using permutation importance
  // +kubebuilder:validation:Optional
  repeated FeatureImportance permutationImportance = 38;

  // The URI of the model forecast
  // +kubebuilder:validation:Optional
  optional string forecastURI = 39;

  // The runtime training details.
  // +kubebuilder:validation:Optional
  optional RuntimeStatus runtime = 40;

  // TrainDatasetLocation specifies the location of the training dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation trainDataset = 41;

  // TestDatasetLocation specifies the location of the testing dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation testDataset = 42;

  // ValidationDataset specifies the location of the validation dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation validationDataset = 43;

  // ObservedGeneration is the last generation that was acted on
  // +kubebuilder:validation:Optional
  optional int64 observedGeneration = 44;

  // The number of rows in the training dataset
  // +kubebuilder:validation:Optional
  optional int32 trainingRows = 45;

  // The number of rows in the testing dataset
  // +kubebuilder:validation:Optional
  optional int32 testingRows = 46;

  // The number of rows in the validation dataset, if applicable
  // +kubebuilder:validation:Optional
  optional int32 validationRows = 47;

  // In the case of failure, the Model resource controller will set this field with a failure reason
  // +kubebuilder:validation:Optional
  optional string failureReason = 48;

  // In the case of failure, the Model resource controller will set this field with a failure message
  // +kubebuilder:validation:Optional
  optional string failureMessage = 49;

  // The progress percentage of the Model, which is derived from the Model's current phase
  // +kubebuilder:validation:Optional
  optional int32 progress = 50;

  // The size of the model binary in bytes
  // +kubebuilder:validation:Optional
  optional int32 sizeInBytes = 51;

  // The measured prediction latency
  // +kubebuilder:validation:Optional
  optional double latency = 52;

  // The URL to the released model
  // +kubebuilder:validation:Optional
  optional string url = 53;

  // The name of the Predictor in the case that the Model has been released and deployed
  // +kubebuilder:validation:Optional
  optional string predictorName = 54;

  // The time at which the Model was set to release
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time releasedAt = 55;

  // The time at which the Model was set to release
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time predictedAt = 56;

  // Sha256 of the model tar file
  // +kubebuilder:validation:Optional
  optional string tarFileHash = 57;

  // Sha256 of the model image
  // +kubebuilder:validation:Optional
  optional string imageHash = 58;

  // TrainingDataHash specifies the hashes for datasets used by the Model
  // +kubebuilder:validation:Optional
  optional DataHashes trainingDataHash = 59;

  // TrainingResources details the resources that were consumed by the training workload
  // +kubebuilder:validation:Optional
  optional ResourceConsumption trainingResources = 60;

  // TestingResources details the resources that were consumed by the testing workload
  // +kubebuilder:validation:Optional
  optional ResourceConsumption testingResources = 61;

  // The Account which trained the model, derived from the parent Study
  // +kubebuilder:validation:Optional
  optional string trainedBy = 62;

  // The team of the Account which trained the model, derived from the parent Study
  // +kubebuilder:validation:Optional
  optional string team = 63;

  // The endpoint of the Model, which is set after it is deployed to a Predictor
  // +kubebuilder:validation:Optional
  optional string endpoint = 64;

  // Logs specifies the location of logs produced by workloads associated with the Model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Logs logs = 65;

  // The Roc/Auc curve of the trained model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.RocAucCurve rocCurve = 66;

  // The Precision/Recall curve of the trained model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.PRCurve prCurve = 67;

  // The confusion matrix of the train data.
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ConfusionMatrix trainConfusionMatrix = 68;

  // The confusion matrix of the test data
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ConfusionMatrix testConfusionMatrix = 69;

  // The collection of correlations of the features of the training dataset and the target feature
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.Correlation correlationsWithTarget = 70;

  // The top correlations between features of the training dataset
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.Correlation topCorrelations = 71;

  // The last time the object was updated
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time updatedAt = 72;

  // Governance specifies the current governance status for the Model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.GovernanceStatus governance = 73;

  // Interpretability contains results produced during the explaining phase of the Model
  // +kubebuilder:validation:Optional
  optional InterpretabilityStatus interpretability = 74;

  // Images specifies the container images used to train the model
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Images images = 75;

  // The result of running the unit tests
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuiteResult unitTestsResult = 76;

  // The result of running the feedback unit tests, the feedback unit tests
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuiteResult feedbackTestsResult = 77;

  // The sub models uri file contain the results of running the sub model
  // +kubebuilder:validation:Optional
  optional ModelGroupByStatus groupby = 78;

  // The status of the model, when deploying via the stages
  // +kubebuilder:validation:Optional
  repeated ModelStageStatus stages = 79;

  // +kubebuilder:validation:Optional
  // +patchMergeKey=type
  // +patchStrategy=merge
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.Condition conditions = 80;
}

// ModelValidation defines a single validation to be run against a model
message ModelTestSuite {
  // Baseline Model Ref specifies a previous model to compare against
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference baselineModelRef = 1;

  // The name of a labeled dataset used to test the model, when measuring a performance metric
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference datasetRef = 2;

  // Define the column name for the validation role
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite unitTests = 3;
}

// NLPEstimatorSpec specifies the configuration for an NLP model
message NLPEstimatorSpec {
  // The name of the base model
  // +kubebuilder:validation:Optional
  optional string base = 1;
}

message NNLayerParameter {
  optional string name = 1;

  optional string value = 2;
}

message PartitionModelLocationsSpec {
  // The folder of group data
  // +kubebuilder:validation:Optional
  optional string partitionFolder = 1;

  // The folder of partition data
  // +kubebuilder:validation:Optional
  optional string partitionProfileFolder = 2;

  // The folder of partition data
  // +kubebuilder:validation:Optional
  optional string partitionReportFile = 3;

  // The folder of partition data
  // +kubebuilder:validation:Optional
  optional string partitionModelFolder = 4;

  // The folder of partition data
  // +kubebuilder:validation:Optional
  optional string partitionModelFile = 5;

  // The folder of partition data
  // +kubebuilder:validation:Optional
  optional string partitionForecastFile = 6;
}

message PercentilePrunerOptions {
  // Percentile which must be between 0 and 100 inclusive
  // +kubebuilder:default:=25
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Maximum=100
  // +kubebuilder:validation:Optional
  optional int32 percentile = 1;

  // Pruning is disabled until the given number of trials finish in the same ModelClass.
  // +kubebuilder:default:=5
  // +kubebuilder:validation:Optional
  optional int32 startupTrials = 2;

  //  Pruning is disabled until the trial exceeds the given number of step
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 warmupSteps = 3;

  // Interval in number of steps between the pruning checks
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 intervalTrials = 4;

  // Minimum number of reported trials.
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 minTrials = 5;
}

// Define a test stage
message PipelineStageSpec {
  // The stage name
  optional string name = 1;

  // the Tests to run on the stage
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite tests = 2;

  // The serving site ref
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference servingSiteRef = 3;

  // The resources to use when running tests at this stage
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 4;
}

message PrunerSpec {
  // The type of pruner to use during model search
  // +kubebuilder:default:=median-pruner
  // +kubebuilder:validation:Optional
  optional string type = 1;

  // +kubebuilder:validation:Optional
  optional MedianPrunerOptions median = 2;

  // +kubebuilder:validation:Optional
  optional PercentilePrunerOptions percentile = 3;

  // +kubebuilder:validation:Optional
  optional SuccessiveHalvingOptions successiveHalving = 4;

  // +kubebuilder:validation:Optional
  optional HyperbandOptions hyperband = 5;

  // +kubebuilder:validation:Optional
  optional ThresholdPrunerOptions threshold = 6;
}

// Define how to build a regression model for forecasting (including feature engineering)
// This is not implemented today
message RegressionForecasterSpec {
  // If true this is an ensemble pipeline
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool ensemble = 1;

  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string imputation = 2;

  // The encoding method to use for categorical data types
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string encoding = 3;

  // The scaling method to use for numerical data types
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string scaling = 4;

  // If true apply the data transofmer to
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool date = 5;

  // The list of windows to use when generating features.
  // +kubebuilder:validation:Optional
  repeated int32 windows = 6;

  // The list of lags to use when generating features
  // +kubebuilder:validation:Optional
  repeated int32 lags = 7;

  // The list of metrics to generate for each combination of lag and windows.
  // The default list is min,max,median,stddev
  // +kubebuilder:validation:Optional
  repeated string functions = 8;

  // when computing moving avg, use exponential moving avg, other use regular moving avg
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool ema = 9;

  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool log = 10;

  // If we are using reduced model, this is the way the reduced model will make prediction
  // Default to none
  // +kubebuilder:validation:Optional
  optional string reduction = 11;
}

// +kubebuilder:object:root=true
// +kubebuilder:resource:path=reports,singular=report,categories={training,modela,all}
// +kubebuilder:subresource:status
// +kubebuilder:storageversion
// +kubebuilder:printcolumn:name="Status",type="string",JSONPath=".status.phase"
// +kubebuilder:printcolumn:name="Owner",type="string",JSONPath=".spec.owner",priority=1
// +kubebuilder:printcolumn:name="Version",type="string",JSONPath=".spec.versionName"
// +kubebuilder:printcolumn:name="Type",type="string",JSONPath=".spec.reportType"
// +kubebuilder:printcolumn:name="Age",type="date",JSONPath=".metadata.creationTimestamp",description=""
// Report represents a PDF file containing information compiled about another resource
message Report {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional ReportSpec spec = 2;

  // +optional
  optional ReportStatus status = 3;
}

message ReportGroupByStatus {
  // The locations of the datasets profile files. Each file is the group
  // +kubebuilder:validation:Optional
  optional string reportsURI = 1;

  // Holds the worker on going result, when a worker finish, we update the location of thier result files
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.WorkerRunResult workerResults = 4;
}

// ReportList contains a list of Reports
// +kubebuilder:object:root=true
message ReportList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Report items = 2;
}

// ReportSpec specifies the desired state of a Report
message ReportSpec {
  // The name of the DataProductVersion which describes the version of the resource
  // that exists in the same DataProduct namespace as the resource
  // +kubebuilder:default:="latest"
  // +kubebuilder:validation:Optional
  optional string versionName = 1;

  // EntityRef specifies the entity which the Report references. The supported entities consist of Entity, Model, and Study resources
  optional k8s.io.api.core.v1.ObjectReference entityRef = 2;

  // The location of the flat-file containing the PDF report
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation location = 5;

  // The type of report (e.g. classification model report, study report)
  // +kubebuilder:validation:Required
  // +required
  optional string reportType = 6;

  // The format of the Report. `pdf` is the only supported type as of the current release
  // +kubebuilder:default:=pdf
  // +kubebuilder:validation:Optional
  optional string format = 7;

  // The name of the Notifier resource which Alerts created by the Report will be forwarded to
  // +kubebuilder:validation:Optional
  optional string notifierName = 8;

  // The name of the Account which created the object, which exists in the same tenant as the object
  // +kubebuilder:default:="no-one"
  // +kubebuilder:validation:Optional
  optional string owner = 9;

  // Resources specifies the resource requirements that will be allocated to the report generation workload
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 10;

  // The deadline for any Jobs associated with the Report to be completed in seconds
  // +kubebuilder:default:=600
  // +kubebuilder:validation:Optional
  optional int64 timeout = 11;

  // Custom contains the specification to generate a custom report (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional CustomReportSpec custom = 12;

  // The reference to the Lab namespace under which the report generation Job will be executed under.
  // If unspecified, the default Lab from the parent DataProduct will be used
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference labRef = 14;

  // For group forecasting, this is the key of the group
  // +kubebuilder:validation:Optional
  repeated string key = 15;

  // The model class for this report if the model was created by a model class
  // +kubebuilder:validation:Optional
  optional string modelClassName = 16;

  // If this report was created by a model class run, this is the run name
  // +kubebuilder:validation:Optional
  optional string modelClassRunName = 17;
}

// ReportStatus defines the observed state of a Report
message ReportStatus {
  // CompletedAt represents the time at which the Report was marked as completed, failed, or aborted
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 1;

  // The phase of the Report
  // +kubebuilder:default:="Pending"
  // +kubebuilder:validation:Optional
  optional string phase = 2;

  // The URI to the flat-file report within the VirtualBucket specified by the Report
  // +kubebuilder:validation:Optional
  optional string uri = 3;

  // ObservedGeneration is the last generation that was acted on
  // +kubebuilder:validation:Optional
  optional int64 observedGeneration = 4;

  // In the case of failure, the Report resource controller will set this field with a failure reason
  // +kubebuilder:validation:Optional
  optional string failureReason = 5;

  // In the case of failure, the Report resource controller will set this field with a failure message
  // +kubebuilder:validation:Optional
  optional string failureMessage = 6;

  // Logs specifies the location of logs produced by workloads associated with the Report
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Logs logs = 7;

  // The last time the object was updated
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time updatedAt = 8;

  // The sub models uri file contain the results of running the sub model
  // +kubebuilder:validation:Optional
  optional ReportGroupByStatus groupby = 9;

  // +patchMergeKey=type
  // +patchStrategy=merge
  // +kubebuilder:validation:Optional
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.Condition conditions = 10;
}

// ResourceConsumption represents the total resources consumed by a workload
message ResourceConsumption {
  optional double cpu = 1;

  optional double mem = 2;

  optional double gpu = 3;
}

// Holds the information about the execution environment.
message RuntimeStatus {
  // The Python version of the data plane used during training
  // +kubebuilder:validation:Optional
  optional string pythonVersion = 1;

  // The python command line
  // +kubebuilder:validation:Optional
  optional string pythonCmd = 2;

  // The OS
  // +kubebuilder:validation:Optional
  optional string os = 3;

  // The Python packages used during training (which is the result of running pip freeze)
  // +kubebuilder:validation:Optional
  map<string, string> pythonPackages = 4;
}

// SearchSpec specifies the configuration for a distributed model search
message SearchSpec {
  // The hyper-parameter optimization search method
  // +kubebuilder:default:=tpe
  // +kubebuilder:validation:Optional
  optional string sampler = 1;

  // Pruner specifies the configuration to run a model search using a pruning algorithm. Using a pruning
  // algorithm allows you to train a large number of candidate models with a subset of the dataset
  // +kubebuilder:validation:Optional
  optional PrunerSpec pruner = 2;

  // The maximum cost that can be incurred before stopping the model search (applicable for deep learning models)
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:=100
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:validation:Maximum=1000
  optional int32 maxCost = 3;

  // The maximum number of minutes, that the model search can run for
  // +kubebuilder:default:=60
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:validation:Maximum=10000
  // +kubebuilder:validation:Optional
  optional int32 maxTime = 4;

  // The maximum number of candidate models that will be sampled and trained
  // +kubebuilder:default:=10
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:validation:Maximum=1000
  // +kubebuilder:validation:Optional
  optional int32 maxModels = 5;

  // The minimum best score needed to finish the search. The system will finish the search when the minimum is reached.
  // Note that this number can be negative for a regression.
  // +kubebuilder:default:=9999999999
  // +kubebuilder:validation:Optional
  optional double minBestScore = 6;

  // The desired number of trainers that will train candidate models in parallel. The number
  // of trainers is restricted based on the allowance provided by the active License
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  // +kubebuilder:validation:Maximum=50
  // +kubebuilder:validation:Minimum=0
  optional int32 trainers = 7;

  // The number of top candidate models that will be moved to the testing phase once the model search is complete.
  // By default, only the best model will be retained
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Minimum=1
  // +kubebuilder:validation:Maximum=5
  optional int32 test = 8;

  // The number of top candidate models, sorted by their objective score, that will be retained in
  // the case that garbage collection is enabled. All other models will be archived
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Maximum=100
  optional int32 retainTop = 9;

  // The time, in minutes, for which candidate models (excluding the best model) will be
  // retained, after which they will be archived
  // +kubebuilder:default:=60
  // +kubebuilder:validation:Minimum=0
  // +kubebuilder:validation:Maximum=2400
  optional int32 retainedFor = 10;

  // SearchSpace specifies the algorithms available to candidate models
  // +kubebuilder:validation:Optional
  optional AlgorithmSearchSpaceSpec searchSpace = 11;

  // The number of new models produced by the search which, if there is no improvement
  // in score, the model search will conclude
  // +kubebuilder:validation:Optional
  optional EarlyStopSpec earlyStop = 12;

  // The objective metric that will be measured against all models to evaluate their performance
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ObjectiveSpec objective = 14;

  // The second objective metric that will be measured and evaluated in tandem with the primary objective.
  // The model search optimizer will attempt to optimize both metrics
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ObjectiveSpec objective2 = 15;

  // Tune best model
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool tune = 16;

  // +kubebuilder:default:="maximize"
  // +kubebuilder:validation:Optional
  optional string goal = 17;
}

// Define the seasonality for a period (yearly / monthly / daily)
message SeasonalityPeriodSpec {
  // Is the seasonality exist
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // Infer the seasonality
  // +kubebuilder:validation:Optional
  optional bool auto = 2;

  // If enabled, the number of data points in the interval
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 fourierOrder = 3;
}

message SeasonalitySpec {
  // If true infer the seasonality
  // +kubebuilder:validation:Optional
  optional bool auto = 1;

  // +kubebuilder:validation:Optional
  optional SeasonalityPeriodSpec yearly = 2;

  // +kubebuilder:validation:Optional
  optional SeasonalityPeriodSpec quarterly = 3;

  // +kubebuilder:validation:Optional
  optional SeasonalityPeriodSpec monthly = 4;

  // +kubebuilder:validation:Optional
  optional SeasonalityPeriodSpec weekly = 5;

  // +kubebuilder:validation:Optional
  optional SeasonalityPeriodSpec daily = 6;
}

message SegmentSpec {
  // The name of the column
  // +kubebuilder:validation:Required
  // +required
  optional string columnName = 1;

  // The segment operation
  // +kubebuilder:validation:Required
  // +required
  optional string op = 2;

  // The value operation
  // +kubebuilder:validation:Required
  // +required
  optional string value = 3;
}

// ServingSpec specifies the requirements to serve a model
message ServingSpec {
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 1;

  // +kubebuilder:default:="cloudpickle"
  // +kubebuilder:validation:Optional
  optional string format = 2;
}

// +kubebuilder:subresource:status
// +kubebuilder:resource:path=studies,singular=study,shortName=sd,categories={training,modela}
// +kubebuilder:object:root=true
// +kubebuilder:storageversion
// +kubebuilder:printcolumn:name="Status",type="string",JSONPath=".status.phase"
// +kubebuilder:printcolumn:name="Progress",type="number",JSONPath=".status.progress",priority=1
// +kubebuilder:printcolumn:name="Owner",type="string",JSONPath=".spec.owner",priority=1
// +kubebuilder:printcolumn:name="Version",type="string",JSONPath=".spec.versionName",priority=1
// +kubebuilder:printcolumn:name="Dataset",type="string",JSONPath=".spec.datasetName"
// +kubebuilder:printcolumn:name="Task",type="string",JSONPath=".spec.task"
// +kubebuilder:printcolumn:name="Objective",type="string",JSONPath=".spec.search.objective.metric"
// +kubebuilder:printcolumn:name="Score",type="number",JSONPath=".status.bestModelScore"
// +kubebuilder:printcolumn:name="Best model",type="string",JSONPath=".status.bestModel"
// +kubebuilder:printcolumn:name="Trained",type="number",JSONPath=".status.search.completed"
// +kubebuilder:printcolumn:name="Tested",type="number",JSONPath=".status.test.completed"
// +kubebuilder:printcolumn:name="StartedAt",type="date",JSONPath=".status.startAt",priority=1
// +kubebuilder:printcolumn:name="CompletedAt",type="date",JSONPath=".status.completedAt",priority=1
// +kubebuilder:printcolumn:name="Last Failure",type="string",JSONPath=".status.lastFailure"
// +kubebuilder:printcolumn:name="Age",type="date",JSONPath=".metadata.creationTimestamp"
// Study represents an automatic search for the best machine learning model for a given dataset
message Study {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ObjectMeta metadata = 1;

  optional StudySpec spec = 2;

  // +optional
  optional StudyStatus status = 3;
}

message StudyGroupByStatus {
  // The locations of the datasets profile files. Each file is the group
  // +kubebuilder:validation:Optional
  optional string studiesURI = 1;

  // Holds the worker on going result, when a worker finish, we update the location of thier result files
  // +kubebuilder:validation:Optional
  repeated github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.WorkerRunResult workerResults = 2;
}

// StudyList contains a list of Studies
// +kubebuilder:object:root=true
message StudyList {
  optional k8s.io.apimachinery.pkg.apis.meta.v1.ListMeta metadata = 1;

  repeated Study items = 2;
}

// StudyPhaseStatus contains the statistics for a single phase of a Study
message StudyPhaseStatus {
  // The time at which the phase started
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time startedAt = 1;

  // The time at which the phase concluded
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 2;

  // The number of models pending training
  // +kubebuilder:validation:Optional
  optional int32 waitingModelsCount = 3;

  // The number of models currently being trained
  // +kubebuilder:validation:Optional
  optional int32 runningModelsCount = 4;

  // The number of models that experienced an error whilst training
  // +kubebuilder:validation:Optional
  optional int32 failedModelsCount = 5;

  // The number of models that have been successfully trained
  // +kubebuilder:validation:Optional
  optional int32 completedModelsCount = 6;

  // Best score so far in this phase. The best score is the value of the objective.
  // +kubebuilder:validation:Optional
  optional double bestScore = 7;

  // Actual number of models where no progress was made. This used to decide on early stop.
  // +kubebuilder:validation:Optional
  optional int32 modelsWithNoProgress = 8;
}

// StudyScheduleSpec specifies the parameters for a Study to be executed at a certain time
message StudyScheduleSpec {
  // Indicates if the schedule is enabled
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool enabled = 1;

  // The time at which the ModelClass will begin execution
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time startAt = 2;
}

// StudySpec defines the desired state of a Study and the parameters for a model search
message StudySpec {
  // The name of the DataProductVersion which describes the version of the resource
  // that exists in the same DataProduct namespace as the resource
  // +kubebuilder:validation:MaxLength=63
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string versionName = 1;

  // The user-provided description of the Study
  // +kubebuilder:default:=""
  // +kubebuilder:validation:MaxLength=512
  // +kubebuilder:validation:Optional
  optional string description = 4;

  // The reference to the Lab under which the Model resources created by the Study will be trained.
  // If unspecified, the default Lab from the parent DataProduct will be used
  // +kubebuilder:validation:Optional
  optional k8s.io.api.core.v1.ObjectReference labRef = 5;

  // The name of the Entity resource that will be used to train models with.
  // The dataset will be split into individual training, testing, and validation datasets
  // +kubebuilder:validation:Required
  // +required
  optional string datasetName = 6;

  // The machine learning task type (i.e. regression, classification)
  // +kubebuilder:validation:Required
  // +required
  optional string task = 7;

  // The machine learning subtask relevant to the primary task (text classification, image object detection, etc.)
  // +kubebuilder:default:=none
  // +kubebuilder:validation:Optional
  optional string subtask = 8;

  // FESearch specifies the parameters to perform a feature engineering search
  // +kubebuilder:validation:Optional
  optional FeatureEngineeringSearchSpec feSearch = 9;

  // Set the imbalance dataset handling.
  // +kubebuilder:validation:Optional
  optional ImbalanceHandlingSpec imbalanceHandler = 10;

  // Baseline specifies the parameters to generate baseline (default hyper-parameters) models
  // +kubebuilder:validation:Optional
  optional BaselineSpec baseline = 11;

  // Search specifies the configuration to perform the model search for the best algorithm and hyper-parameters
  // +kubebuilder:validation:Optional
  optional SearchSpec search = 12;

  // Ensembles specifies to parameters to generate ensemble models
  // +kubebuilder:validation:Optional
  optional EnsemblesSpec ensembles = 13;

  // TrainingTemplate specifies the configuration to train and evaluate models
  // +kubebuilder:validation:Optional
  optional TrainingSpec trainingTemplate = 14;

  // ServingTemplate specifies the model format and resource requirements that will be applied to
  // the Predictor created for the Model that will be selected by the Study
  // +kubebuilder:validation:Optional
  optional ServingSpec servingTemplate = 15;

  // ForecastSpec specifies the parameters required when generating a forecasting model
  // +kubebuilder:validation:Optional
  optional ForecasterSpec fctTemplate = 16;

  // Schedule specifies the configuration to execute the Study at a later date
  // +kubebuilder:validation:Optional
  optional StudyScheduleSpec schedule = 17;

  // Interpretability specifies the parameters to create interpretability visualizations for the final model
  // +kubebuilder:validation:Optional
  optional InterpretabilitySpec interpretability = 18;

  // +kubebuilder:validation:Optional
  optional DriftModelSpec driftDetection = 19;

  // Aborted indicates that the execution of the Study and associated Models should be permanently stopped
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool aborted = 20;

  // Reported indicates that a report will be generated for the Study
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool reported = 21;

  // Paused indicates that the execution of new workloads associated with the Study should be paused
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool paused = 22;

  // Profiled indicates that the Study will be profiled after the conclusion of it's model search
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool profiled = 23;

  // ModelPublished indicates that a Docker image will be created containing the best model produced by the Study
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool modelPublished = 24;

  // ModelImagePushed indicates that if a Docker image of the best model will be pushed to a Docker image registry
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool modelImagePushed = 25;

  // ModelExplained indicates if interpretability diagrams, as specified
  // by the Interpretability field, will be produced for the final model
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool modelExplained = 26;

  // Fast indicates if ModelsCount associated with the Study should skip profiling, explaining, and reporting
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool fast = 27;

  // The data location where Study artifacts (metadata, reports, and model artifacts) generated by the Study will be stored
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation location = 28;

  // The name of the Account which created the object, which exists in the same tenant as the object
  // +kubebuilder:default:="no-one"
  // +kubebuilder:validation:Optional
  optional string owner = 29;

  // CompilerSpec specifies the configuration to compile the best-selected model to a binary (currently unimplemented)
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.CompilerSpec compilation = 30;

  // Indicates if the Study is a template, in which case it will not be executed
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool template = 31;

  // Indicates if the Study is flagged
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool flagged = 32;

  // The notification specification that determines which notifiers will receive Alerts generated by the object
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.NotificationSpec notification = 33;

  // ModelImage specifies the configuration to upload Docker images of models to an image registry
  // +kubebuilder:validation:Optional
  optional ModelImageSpec modelImage = 34;

  // GarbageCollectionSpec specifies the configuration to automatically clean-up unused models
  // +kubebuilder:validation:Optional
  optional GarbageCollectionSpec gc = 35;

  // The time-to-live, in seconds, for Model resources produced by the Study
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 ttl = 36;

  // ModelVersion specifies the version assigned to all the Model resources produced by the Study
  // +kubebuilder:default:=""
  // +kubebuilder:validation:Optional
  optional string modelVersion = 37;

  // The time, in seconds, after which the execution of the Study will be forcefully aborted (4 hours, by default)
  // +kubebuilder:default:= 14400
  // +kubebuilder:validation:Optional
  optional int32 timeout = 38;

  // Not implemented. For future use. If true,generate code when the best model
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool codeGenerated = 39;

  // A template for models unit tests
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.TestSuite unitTestsTemplate = 40;

  // In case of a group by, those are the group locations
  // +kubebuilder:validation:Optional
  optional GroupSplitLocationsSpec groupLocations = 41;

  // The model class for this study if the model was created by a model class
  // +kubebuilder:validation:Optional
  optional string modelClassName = 42;

  // If this study was created by a model class run, this is the run name
  // +kubebuilder:validation:Optional
  optional string modelClassRunName = 43;
}

// StudyStatus defines the observed state of a Study
message StudyStatus {
  // Total models created for the study
  // +kubebuilder:validation:Optional
  optional int32 modelsCount = 1;

  // CompletedAt represents the time at which the Study was marked as completed, failed, or aborted
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time completedAt = 3;

  // The name of the Model resource which was determined to be the highest-performing
  // +kubebuilder:validation:Optional
  optional string bestModel = 4;

  // The score of the Model resource which was determined to be the highest-performing
  // +kubebuilder:validation:Optional
  optional double bestModelScore = 5;

  // The URI of the raw profile data produced by the Study
  // +kubebuilder:validation:Optional
  optional string profileURI = 6;

  // The name of the Report resource produced by the Study
  // +kubebuilder:validation:Optional
  optional string reportURI = 7;

  // Reference to the report object that was generated for the dataset, which exists in the same Location Product namespace
  // as the object
  // +kubebuilder:validation:Optional
  optional string reportName = 8;

  // The phase of the Study
  // +kubebuilder:default:="Pending"
  // +kubebuilder:validation:Optional
  optional string phase = 9;

  // ObservedGeneration is the last generation that was acted on
  // +kubebuilder:validation:Optional
  optional int64 observedGeneration = 10;

  // TrainDatasetLocation specifies the location of the training dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation trainDataset = 11;

  // TestDatasetLocation specifies the location of the testing dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation testDataset = 12;

  // ValidationDataset specifies the location of the validation dataset
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.data.v1alpha1.DataLocation validationDataset = 13;

  // The Kubernetes-internal ID of the last Model resource generated by the Study
  optional int64 lastModelID = 14;

  // In the case of failure, the Study resource controller will set this field with a failure reason
  // +kubebuilder:validation:Optional
  optional string failureReason = 15;

  // In the case of failure, the Study resource controller will set this field with a failure message
  // +kubebuilder:validation:Optional
  optional string failureMessage = 16;

  // The number of rows in the training dataset
  // +kubebuilder:validation:Optional
  optional int32 trainingRowsCount = 17;

  // The number of rows in the testing dataset
  // +kubebuilder:validation:Optional
  optional int32 testingRowsCount = 18;

  // The number of rows in the validation dataset
  // +kubebuilder:validation:Optional
  optional int32 validationRowsCount = 19;

  // The progress percentage of the Study, which is derived from the Study's current phase
  // +kubebuilder:validation:Optional
  optional int32 progress = 20;

  // Sha 256 of the data sig
  // +kubebuilder:validation:Optional
  // TrainingDataHash specifies the hashes for datasets used by the Study
  // +kubebuilder:validation:Optional
  optional DataHashes trainingDataHash = 22;

  // The type of trigger which started the Study
  // +kubebuilder:validation:Optional
  optional string triggeredBy = 23;

  // Logs specifies the location of logs produced by workloads associated with the Study
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.Logs logs = 24;

  // FeatureEngineeringStatus contains the status of the feature engineering phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus featureEngineering = 25;

  // BaselineStatus contains the status of the baseline phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus baseline = 26;

  // SearchStatus contains the status of the model search phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus search = 27;

  // EnsembleStatus contains the status of the ensemble phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus ensemble = 28;

  // TestStatus contains the status of the testing phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus test = 29;

  // ExplainStatus contains the status of the explaining phase
  // +kubebuilder:validation:Optional
  optional StudyPhaseStatus explain = 30;

  // OutlierDetection is the status for outlier detection
  // +kubebuilder:validation:Optional
  optional DriftDetectorStatus driftDetection = 31;

  // The last time the object was updated
  // +kubebuilder:validation:Optional
  optional k8s.io.apimachinery.pkg.apis.meta.v1.Time updatedAt = 32;

  // BestFE specifies the best feature engineering pipeline produced by the Study
  // +kubebuilder:validation:Optional
  optional FeatureEngineeringSpec bestFE = 33;

  // GC specifies the status of garbage collection relevant to the Study
  optional GarbageCollectionStatus gc = 34;

  // Study group by
  optional StudyGroupByStatus groupby = 35;

  // +optional
  // +patchMergeKey=type
  // +patchStrategy=merge
  repeated k8s.io.apimachinery.pkg.apis.meta.v1.Condition conditions = 36;
}

message SuccessiveHalvingOptions {
  // Minimum number of reported trials.
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 minResources = 1;

  // A parameter for specifying reduction factor of promotable trials
  // +kubebuilder:default:=4
  // +kubebuilder:validation:Optional
  optional int32 reductionFactor = 2;

  // A parameter for specifying the minimum early-stopping rate
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 minEarlyStoppingRate = 3;

  // Minimum number of trials that need to complete a rung before any trial is considered for promotion into the next rung.
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 bootstrapCount = 4;
}

// SuccessiveHalvingSpec records the position of a single model in a successive halving search
message SuccessiveHalvingSpec {
  // The budget to be used in a multi-fidelity search, for example the number of epochs
  // or the percentage of data to train the model with
  // +kubebuilder:validation:Optional
  // +kubebuilder:validation:Maximum=128
  // +kubebuilder:validation:Minimum=0
  optional int32 budget = 1;

  // The bracket of the model
  // +kubebuilder:validation:Optional
  // +kubebuilder:validation:Maximum=128
  // +kubebuilder:validation:Minimum=0
  optional int32 bracket = 2;

  // The rung of the model
  // +kubebuilder:validation:Optional
  // +kubebuilder:validation:Maximum=128
  // +kubebuilder:validation:Minimum=0
  optional int32 rung = 3;

  // The configuration ID allocated to the model
  // +kubebuilder:validation:Optional
  optional int32 confID = 4;

  // The type of modality, based on the type of model
  // For classical models, it should be based on data percentage
  // For deep models, it should be based on epochs
  // +kubebuilder:validation:Optional
  optional string modality = 26;
}

// TextPipelineSpec represents a single pipeline for transforming text data
message TextPipelineSpec {
  // The text encoder (e.g. TFIDF)
  // +kubebuilder:default:=auto
  // +kubebuilder:validation:Optional
  optional string encoder = 1;

  // The text tokenizer character
  // +kubebuilder:validation:Optional
  optional string tokenizer = 2;

  // Indicates if the pipeline will add stop word handling
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool stopwords = 3;

  // Indicates if the pipeline will add part-of-speech handling
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool pos = 4;

  // Indicates if the pipeline will implement lemmatization
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool lemma = 5;

  // Indicates if the pipeline will implement word stemming
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool stem = 6;

  // Indicates if the pipeline will generate a word embedding
  // +kubebuilder:validation:Optional
  optional string embedding = 7;

  // Indicates if the pipeline will add singular value decomposition
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool svd = 8;

  // The maximum number of SVD components to use, if applicable
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 maxSvdComponents = 9;
}

message ThresholdPrunerOptions {
  // A minimum value which determines whether pruner prunes or not. If an intermediate value is smaller than lower, it prunes.
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional double lower = 1;

  // A maximum value which determines whether pruner prunes or not. If an intermediate value is larger than upper, it prunes.
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional double upper = 2;

  //  Pruning is disabled until the trial exceeds the given number of step
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 warmupSteps = 3;

  // Interval in number of steps between the pruning checks
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 intervalSteps = 4;
}

message TimeSeriesEvent {
  // Set to true if this event is an holiday
  // +kubebuilder:validation:Optional
  optional string name = 1;

  // Set to true if this event is an holiday
  // +kubebuilder:validation:Optional
  optional string method = 2;

  // Set to true if this event is an holiday
  // +kubebuilder:validation:Optional
  optional bool holiday = 3;

  // If this event is an holiday, this is the holiday country
  // +kubebuilder:validation:Optional
  optional string country = 4;

  // Pre event window, that might have event effects
  // +kubebuilder:validation:Optional
  optional int32 preEvent = 5;

  // Post event windows the might have event effects.
  // +kubebuilder:validation:Optional
  optional int32 postEvent = 6;

  // The time points to mark the events
  // +kubebuilder:validation:Optional
  repeated string timePoints = 7;
}

// TrainingSpec specifies the configuration of a model training workload
message TrainingSpec {
  // The reference to the Lab under which the model training Job will be created
  optional k8s.io.api.core.v1.ObjectReference labRef = 1;

  // The priority of the Kubernetes Job created by the Model (medium, by default)
  // +kubebuilder:validation:Optional
  // +kubebuilder:default:="medium"
  optional string priority = 2;

  // The type of cross-validation to use, in the case that a validation dataset is not enabled
  // +kubebuilder:default:=kfold
  // +kubebuilder:validation:Optional
  optional string cvtype = 3;

  // Indicates if cross-validation should be used to score models
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool cV = 4;

  // The number of folds to use during cross-validation
  // +kubebuilder:default:=5
  // +kubebuilder:validation:Optional
  optional int32 folds = 5;

  // Split specifies the configuration to generate training, testing, and validation datasets
  // +kubebuilder:validation:Optional
  optional DataSplitSpec split = 6;

  // EvalMetrics specifies the collection of metrics that will be evaluated after model training is complete
  // +kubebuilder:validation:Optional
  repeated string evalMetrics = 7;

  // SuccessiveHalving specifies the configuration for a Study to execute a model search using successive halving
  // +kubebuilder:validation:Optional
  optional SuccessiveHalvingSpec sh = 10;

  // The random state used for the model's estimator, if applicable (for example, in RandomForestClassifier)
  // +kubebuilder:default:=42
  // +kubebuilder:validation:Optional
  optional double seed = 11;

  // Resources specifies the resource requirements allocated to the model training workload
  // +kubebuilder:validation:Optional
  optional github.com.metaprov.modelaapi.pkg.apis.catalog.v1alpha1.ResourceSpec resources = 12;

  // Indicates if a GPU will be allocated for model training
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool gpu = 13;

  // Indicates if model training will be distributed across multiple nodes (currently unimplemented)
  // +kubebuilder:default:=false
  // +kubebuilder:validation:Optional
  optional bool distributed = 14;

  // Indicates if feature importance for the model will be computed as part of training. Some algorithms
  // (e.g. Random Forest) have built in support for feature importance
  // +kubebuilder:default:=true
  // +kubebuilder:validation:Optional
  optional bool featureImportance = 15;

  // The number of nodes to use, in the case of distributed training
  // +kubebuilder:default:=1
  // +kubebuilder:validation:Optional
  optional int32 nodeCount = 16;

  // The number percentage (0 through 100) of rows to be used during training
  // +kubebuilder:default:=100
  // +kubebuilder:validation:Optional
  optional int32 samplePct = 17;

  // Checkpoint specifies the location to store model checkpoints
  // +kubebuilder:validation:Optional
  optional CheckpointSpec checkpoint = 18;

  // The maximum log level for logs produced by Jobs associated with the Model
  // +kubebuilder:default:=info
  // +kubebuilder:validation:Optional
  optional string logLevel = 19;

  // The maximum time, in seconds, that Jobs associated with the Model can run for before being forcefully cancelled.
  // +kubebuilder:default:=600
  // +kubebuilder:validation:Optional
  optional int32 timeoutInSecs = 20;
}

message UnivariateForecastStatus {
  // URI for the grid search result
  // +kubebuilder:validation:Optional
  optional string gridSearchResultURI = 1;

  // The best estimator
  // +kubebuilder:validation:Optional
  optional ClassicalEstimatorSpec baseEstimator = 2;

  // URI of the model
  // +kubebuilder:validation:Optional
  optional string modelURI = 3;

  // URI of the backtest result
  // +kubebuilder:validation:Optional
  optional string cvResultURI = 4;

  // URI to the actual forecast
  // +kubebuilder:validation:Optional
  optional string forecastURI = 5;
}

// VideoPipelineSpec represents a single pipeline for preprocessing video data
message VideoPipelineSpec {
  // The date time imputer.
  // +kubebuilder:default:="auto"
  // +kubebuilder:validation:Optional
  optional string featurizer = 1;
}

// Define a window on the time series.
message WindowSpec {
  // The period interval
  // +kubebuilder:validation:Optional
  optional string interval = 1;

  // The number of intervals to start. If the start is more than 0, there is a gap.
  // +kubebuilder:default:=0
  // +kubebuilder:validation:Optional
  optional int32 start = 2;

  // The window length
  // +kubebuilder:validation:Optional
  optional int32 length = 3;
}

